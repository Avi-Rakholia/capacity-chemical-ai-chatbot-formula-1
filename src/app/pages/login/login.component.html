<div class="container d-flex justify-content-center py-5">
  <div class="login-card card p-5 shadow-sm">
    <div class="text-center mb-3">
      <img src="assets/capacity-chemical-logo.svg" alt="Logo" class="logo-img" />
    </div>

    <h1 class="text-center display-6 fw-semibold text-muted mb-1">
      Account Log In
    </h1>

    <p class="text-center text-muted mb-4">
      Don't have an account?
      <a
        class="text-decoration-underline text-muted"
        (click)="navigateToCreateAccount()"
        role="button"
      >
        Create Account
      </a>
    </p>

    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" novalidate>
      @if (errorMessage()) {
        <div class="alert alert-danger" role="alert">
          {{ errorMessage() }}
        </div>
      }

      <!-- EMAIL -->
      <div class="mb-3">
        <label for="email" class="form-label text-muted">Email</label>
        <input
          id="email"
          class="form-control form-control-lg rounded-3"
          type="email"
          placeholder="abc@capacitychemical.com"
          formControlName="email"
        />
      </div>

      <!-- PASSWORD -->
      <div class="mb-2 position-relative password-section">
        <label for="password" class="form-label text-muted">Password</label>
        <input
          id="password"
          class="form-control form-control-lg rounded-3"
          [type]="passwordVisible() ? 'text' : 'password'"
          placeholder="Password"
          formControlName="password"
        />

        <button
          type="button"
          class="btn btn-sm btn-link position-absolute password-toggle"
          aria-label="toggle password visibility"
          (click)="togglePasswordVisibility()"
        >
          {{ passwordVisible() ? 'Hide' : 'Show' }}
        </button>
      </div>

      <!-- FORGOT PASSWORD LINK -->
      <div class="forgot-password text-end mb-3">
        <button
          type="button"
          class="btn btn-link p-0"
          (click)="openForgotPassword()"
        >
          Forgot password?
        </button>
      </div>

      <!-- SUBMIT -->
      <div class="text-center mt-4">
        <button
          type="submit"
          class="btn btn-primary rounded-pill"
          [disabled]="loginForm.invalid || isLoading()"
        >
          @if (isLoading()) {
            <span
              class="spinner-border spinner-border-sm me-2"
              role="status"
              aria-hidden="true"
            ></span>
          }
          {{ isLoading() ? 'Signing In...' : 'Log In' }}
        </button>
      </div>
    </form>
  </div>
</div>

<!-- ================= FORGOT PASSWORD MODAL ================= -->

<div class="modal-backdrop" *ngIf="showForgotPassword">
  <div class="custom-modal">
    <h2 class="mb-2">Reset Password</h2>
    <p class="text-muted mb-3">
      Enter your email and weâ€™ll send you a reset link.
    </p>

    <form [formGroup]="forgotPasswordForm">
      <input
        type="email"
        class="form-control mb-3"
        placeholder="Enter your email"
        formControlName="email"
      />
    </form>
<!-- SUCCESS MESSAGE -->
@if (forgotSuccessMessage()) {
  <div class="forgot-success">
    {{ forgotSuccessMessage() }}
  </div>
}

<!-- ERROR MESSAGE -->
@if (errorMessage()) {
  <div class="forgot-error">
    {{ errorMessage() }}
  </div>
}


    <div class="modal-actions d-flex justify-content-end gap-2">
      <button class="btn btn-outline-secondary" (click)="closeForgotPassword()">
        Cancel
      </button>
      <button class="btn btn-primary" (click)="submitForgotPassword()">
        Send Reset Link
      </button>
    </div>
  </div>
</div>
